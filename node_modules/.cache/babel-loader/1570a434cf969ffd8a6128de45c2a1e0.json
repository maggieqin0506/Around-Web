{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/maggie/Documents/Projects/Around-Web/src/components/Home.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\nimport SearchBar from \"./SearchBar\";\nimport PhotoGallery from \"./PhotoGallery\";\nimport CreatePostButton from \"./CreatePostButton\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\nconst {\n  TabPane\n} = Tabs;\n\nfunction Home(props) {\n  _s();\n\n  const [posts, setPost] = useState([]);\n  const [activeTab, setActiveTab] = useState(\"image\");\n  const [searchOption, setSearchOption] = useState({\n    type: SEARCH_KEY.all,\n    keyword: \"\"\n  });\n\n  const handleSearch = option => {\n    const {\n      type,\n      keyword\n    } = option;\n    setSearchOption({\n      type: type,\n      keyword: keyword\n    });\n  };\n\n  useEffect(() => {\n    const {\n      type,\n      keyword\n    } = searchOption;\n    fetchPost(searchOption);\n  }, [searchOption]);\n\n  const fetchPost = option => {\n    const {\n      type,\n      keyword\n    } = option;\n    let url = \"\";\n\n    if (type === SEARCH_KEY.all) {\n      url = `${BASE_URL}/search`;\n    } else if (type === SEARCH_KEY.user) {\n      url = `${BASE_URL}/search?user=${keyword}`;\n    } else {\n      url = `${BASE_URL}/search?keywords=${keyword}`;\n    }\n\n    const opt = {\n      method: \"GET\",\n      url: url,\n      headers: {\n        Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n      }\n    };\n    axios(opt).then(res => {\n      if (res.status === 200) {\n        setPost(res.data);\n      }\n    }).catch(err => {\n      message.error(\"Fetch posts failed!\");\n      console.log(\"fetch posts failed: \", err.message);\n    });\n  };\n\n  const renderPosts = type => {\n    if (!posts || posts.length === 0) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: \"No data!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 20\n      }, this);\n    }\n\n    if (type === \"image\") {\n      const imageArr = posts.filter(item => item.type === \"image\").map(image => {\n        return {\n          src: image.url,\n          user: image.user,\n          caption: image.message,\n          thumbnail: image.url,\n          thumbnailWidth: 300,\n          thumbnailHeight: 200\n        };\n      });\n      return /*#__PURE__*/_jsxDEV(PhotoGallery, {\n        images: imageArr\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 20\n      }, this);\n    } else if (type === \"video\") {\n      return /*#__PURE__*/_jsxDEV(Row, {\n        gutter: 32,\n        children: posts.filter(post => post.type === \"video\").map(post => /*#__PURE__*/_jsxDEV(Col, {\n          span: 8,\n          children: [/*#__PURE__*/_jsxDEV(\"video\", {\n            src: post.url,\n            controls: true,\n            className: \"video-block\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [post.user, \": \", post.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 33\n          }, this)]\n        }, post.url, true, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 29\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this);\n    }\n  };\n\n  const showPost = type => {\n    console.log(\"type -> \", type);\n    setActiveTab(type);\n    setTimeout(() => {\n      setSearchOption({\n        type: SEARCH_KEY.all,\n        keyword: \"\"\n      });\n    }, 3000);\n  };\n\n  const operations = /*#__PURE__*/_jsxDEV(CreatePostButton, {\n    onShowPost: showPost\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 24\n  }, this);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"home\",\n    children: [/*#__PURE__*/_jsxDEV(SearchBar, {\n      handleSearch: handleSearch\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"display\",\n      children: /*#__PURE__*/_jsxDEV(Tabs, {\n        onChange: key => setActiveTab(key),\n        defaultActiveKey: \"image\",\n        activeKey: activeTab,\n        tabBarExtraContent: operations,\n        children: [/*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Images\",\n          children: renderPosts(\"image\")\n        }, \"image\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TabPane, {\n          tab: \"Videos\",\n          children: renderPosts(\"video\")\n        }, \"video\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Home, \"r+qIcj+crzEBNcUOXNIfbA8432M=\");\n\n_c = Home;\nexport default Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["/Users/maggie/Documents/Projects/Around-Web/src/components/Home.js"],"names":["React","useState","useEffect","Tabs","message","Row","Col","Button","axios","SearchBar","PhotoGallery","CreatePostButton","SEARCH_KEY","BASE_URL","TOKEN_KEY","TabPane","Home","props","posts","setPost","activeTab","setActiveTab","searchOption","setSearchOption","type","all","keyword","handleSearch","option","fetchPost","url","user","opt","method","headers","Authorization","localStorage","getItem","then","res","status","data","catch","err","error","console","log","renderPosts","length","imageArr","filter","item","map","image","src","caption","thumbnail","thumbnailWidth","thumbnailHeight","post","showPost","setTimeout","operations","key"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,IAAT,EAAeC,OAAf,EAAwBC,GAAxB,EAA6BC,GAA7B,EAAkCC,MAAlC,QAAgD,MAAhD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAOC,gBAAP,MAA6B,oBAA7B;AACA,SAASC,UAAT,EAAqBC,QAArB,EAA+BC,SAA/B,QAAgD,cAAhD;AAEA,MAAM;AAAEC,EAAAA;AAAF,IAAcZ,IAApB;;AAEA,SAASa,IAAT,CAAcC,KAAd,EAAqB;AAAA;;AACjB,QAAM,CAACC,KAAD,EAAQC,OAAR,IAAmBlB,QAAQ,CAAC,EAAD,CAAjC;AACA,QAAM,CAACmB,SAAD,EAAYC,YAAZ,IAA4BpB,QAAQ,CAAC,OAAD,CAA1C;AACA,QAAM,CAACqB,YAAD,EAAeC,eAAf,IAAkCtB,QAAQ,CAAC;AAC7CuB,IAAAA,IAAI,EAAEZ,UAAU,CAACa,GAD4B;AAE7CC,IAAAA,OAAO,EAAE;AAFoC,GAAD,CAAhD;;AAKA,QAAMC,YAAY,GAAIC,MAAD,IAAY;AAC7B,UAAM;AAAEJ,MAAAA,IAAF;AAAQE,MAAAA;AAAR,QAAoBE,MAA1B;AACAL,IAAAA,eAAe,CAAC;AAAEC,MAAAA,IAAI,EAAEA,IAAR;AAAcE,MAAAA,OAAO,EAAEA;AAAvB,KAAD,CAAf;AACH,GAHD;;AAKAxB,EAAAA,SAAS,CAAC,MAAM;AACZ,UAAM;AAAEsB,MAAAA,IAAF;AAAQE,MAAAA;AAAR,QAAoBJ,YAA1B;AACAO,IAAAA,SAAS,CAACP,YAAD,CAAT;AACH,GAHQ,EAGN,CAACA,YAAD,CAHM,CAAT;;AAKA,QAAMO,SAAS,GAAID,MAAD,IAAY;AAC1B,UAAM;AAAEJ,MAAAA,IAAF;AAAQE,MAAAA;AAAR,QAAoBE,MAA1B;AACA,QAAIE,GAAG,GAAG,EAAV;;AAEA,QAAIN,IAAI,KAAKZ,UAAU,CAACa,GAAxB,EAA6B;AACzBK,MAAAA,GAAG,GAAI,GAAEjB,QAAS,SAAlB;AACH,KAFD,MAEO,IAAIW,IAAI,KAAKZ,UAAU,CAACmB,IAAxB,EAA8B;AACjCD,MAAAA,GAAG,GAAI,GAAEjB,QAAS,gBAAea,OAAQ,EAAzC;AACH,KAFM,MAEA;AACHI,MAAAA,GAAG,GAAI,GAAEjB,QAAS,oBAAmBa,OAAQ,EAA7C;AACH;;AAED,UAAMM,GAAG,GAAG;AACRC,MAAAA,MAAM,EAAE,KADA;AAERH,MAAAA,GAAG,EAAEA,GAFG;AAGRI,MAAAA,OAAO,EAAE;AACLC,QAAAA,aAAa,EAAG,UAASC,YAAY,CAACC,OAAb,CAAqBvB,SAArB,CAAgC;AADpD;AAHD,KAAZ;AAQAN,IAAAA,KAAK,CAACwB,GAAD,CAAL,CACKM,IADL,CACWC,GAAD,IAAS;AACX,UAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AACpBrB,QAAAA,OAAO,CAACoB,GAAG,CAACE,IAAL,CAAP;AACH;AACJ,KALL,EAMKC,KANL,CAMYC,GAAD,IAAS;AACZvC,MAAAA,OAAO,CAACwC,KAAR,CAAc,qBAAd;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ,EAAoCH,GAAG,CAACvC,OAAxC;AACH,KATL;AAUH,GA9BD;;AAgCA,QAAM2C,WAAW,GAAIvB,IAAD,IAAU;AAC1B,QAAI,CAACN,KAAD,IAAUA,KAAK,CAAC8B,MAAN,KAAiB,CAA/B,EAAkC;AAC9B,0BAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAP;AACH;;AACD,QAAIxB,IAAI,KAAK,OAAb,EAAsB;AAClB,YAAMyB,QAAQ,GAAG/B,KAAK,CACjBgC,MADY,CACJC,IAAD,IAAUA,IAAI,CAAC3B,IAAL,KAAc,OADnB,EAEZ4B,GAFY,CAEPC,KAAD,IAAW;AACZ,eAAO;AACHC,UAAAA,GAAG,EAAED,KAAK,CAACvB,GADR;AAEHC,UAAAA,IAAI,EAAEsB,KAAK,CAACtB,IAFT;AAGHwB,UAAAA,OAAO,EAAEF,KAAK,CAACjD,OAHZ;AAIHoD,UAAAA,SAAS,EAAEH,KAAK,CAACvB,GAJd;AAKH2B,UAAAA,cAAc,EAAE,GALb;AAMHC,UAAAA,eAAe,EAAE;AANd,SAAP;AAQH,OAXY,CAAjB;AAaA,0BAAO,QAAC,YAAD;AAAc,QAAA,MAAM,EAAET;AAAtB;AAAA;AAAA;AAAA;AAAA,cAAP;AACH,KAfD,MAeO,IAAIzB,IAAI,KAAK,OAAb,EAAsB;AACzB,0BACI,QAAC,GAAD;AAAK,QAAA,MAAM,EAAE,EAAb;AAAA,kBACKN,KAAK,CACDgC,MADJ,CACYS,IAAD,IAAUA,IAAI,CAACnC,IAAL,KAAc,OADnC,EAEI4B,GAFJ,CAESO,IAAD,iBACD,QAAC,GAAD;AAAK,UAAA,IAAI,EAAE,CAAX;AAAA,kCACI;AAAO,YAAA,GAAG,EAAEA,IAAI,CAAC7B,GAAjB;AAAsB,YAAA,QAAQ,EAAE,IAAhC;AAAsC,YAAA,SAAS,EAAC;AAAhD;AAAA;AAAA;AAAA;AAAA,kBADJ,eAEI;AAAA,uBACK6B,IAAI,CAAC5B,IADV,QACkB4B,IAAI,CAACvD,OADvB;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ;AAAA,WAAmBuD,IAAI,CAAC7B,GAAxB;AAAA;AAAA;AAAA;AAAA,gBAHP;AADL;AAAA;AAAA;AAAA;AAAA,cADJ;AAcH;AACJ,GAnCD;;AAqCA,QAAM8B,QAAQ,GAAIpC,IAAD,IAAU;AACvBqB,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBtB,IAAxB;AACAH,IAAAA,YAAY,CAACG,IAAD,CAAZ;AAEAqC,IAAAA,UAAU,CAAC,MAAM;AACbtC,MAAAA,eAAe,CAAC;AAAEC,QAAAA,IAAI,EAAEZ,UAAU,CAACa,GAAnB;AAAwBC,QAAAA,OAAO,EAAE;AAAjC,OAAD,CAAf;AACH,KAFS,EAEP,IAFO,CAAV;AAGH,GAPD;;AASA,QAAMoC,UAAU,gBAAG,QAAC,gBAAD;AAAkB,IAAA,UAAU,EAAEF;AAA9B;AAAA;AAAA;AAAA;AAAA,UAAnB;;AACA,sBACI;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA,4BACI,QAAC,SAAD;AAAW,MAAA,YAAY,EAAEjC;AAAzB;AAAA;AAAA;AAAA;AAAA,YADJ,eAEI;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA,6BACI,QAAC,IAAD;AACI,QAAA,QAAQ,EAAGoC,GAAD,IAAS1C,YAAY,CAAC0C,GAAD,CADnC;AAEI,QAAA,gBAAgB,EAAC,OAFrB;AAGI,QAAA,SAAS,EAAE3C,SAHf;AAII,QAAA,kBAAkB,EAAE0C,UAJxB;AAAA,gCAMI,QAAC,OAAD;AAAS,UAAA,GAAG,EAAC,QAAb;AAAA,oBACKf,WAAW,CAAC,OAAD;AADhB,WAA0B,OAA1B;AAAA;AAAA;AAAA;AAAA,gBANJ,eASI,QAAC,OAAD;AAAS,UAAA,GAAG,EAAC,QAAb;AAAA,oBACKA,WAAW,CAAC,OAAD;AADhB,WAA0B,OAA1B;AAAA;AAAA;AAAA;AAAA,gBATJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADJ;AAAA;AAAA;AAAA;AAAA,YAFJ;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ;AAoBH;;GArHQ/B,I;;KAAAA,I;AAuHT,eAAeA,IAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Tabs, message, Row, Col, Button } from \"antd\";\nimport axios from \"axios\";\n\nimport SearchBar from \"./SearchBar\";\nimport PhotoGallery from \"./PhotoGallery\";\nimport CreatePostButton from \"./CreatePostButton\";\nimport { SEARCH_KEY, BASE_URL, TOKEN_KEY } from \"../constants\";\n\nconst { TabPane } = Tabs;\n\nfunction Home(props) {\n    const [posts, setPost] = useState([]);\n    const [activeTab, setActiveTab] = useState(\"image\");\n    const [searchOption, setSearchOption] = useState({\n        type: SEARCH_KEY.all,\n        keyword: \"\"\n    });\n\n    const handleSearch = (option) => {\n        const { type, keyword } = option;\n        setSearchOption({ type: type, keyword: keyword });\n    };\n\n    useEffect(() => {\n        const { type, keyword } = searchOption;\n        fetchPost(searchOption);\n    }, [searchOption]);\n\n    const fetchPost = (option) => {\n        const { type, keyword } = option;\n        let url = \"\";\n\n        if (type === SEARCH_KEY.all) {\n            url = `${BASE_URL}/search`;\n        } else if (type === SEARCH_KEY.user) {\n            url = `${BASE_URL}/search?user=${keyword}`;\n        } else {\n            url = `${BASE_URL}/search?keywords=${keyword}`;\n        }\n\n        const opt = {\n            method: \"GET\",\n            url: url,\n            headers: {\n                Authorization: `Bearer ${localStorage.getItem(TOKEN_KEY)}`\n            }\n        };\n\n        axios(opt)\n            .then((res) => {\n                if (res.status === 200) {\n                    setPost(res.data);\n                }\n            })\n            .catch((err) => {\n                message.error(\"Fetch posts failed!\");\n                console.log(\"fetch posts failed: \", err.message);\n            });\n    };\n\n    const renderPosts = (type) => {\n        if (!posts || posts.length === 0) {\n            return <div>No data!</div>;\n        }\n        if (type === \"image\") {\n            const imageArr = posts\n                .filter((item) => item.type === \"image\")\n                .map((image) => {\n                    return {\n                        src: image.url,\n                        user: image.user,\n                        caption: image.message,\n                        thumbnail: image.url,\n                        thumbnailWidth: 300,\n                        thumbnailHeight: 200\n                    };\n                });\n\n            return <PhotoGallery images={imageArr} />;\n        } else if (type === \"video\") {\n            return (\n                <Row gutter={32}>\n                    {posts\n                        .filter((post) => post.type === \"video\")\n                        .map((post) => (\n                            <Col span={8} key={post.url}>\n                                <video src={post.url} controls={true} className=\"video-block\" />\n                                <p>\n                                    {post.user}: {post.message}\n                                </p>\n                            </Col>\n                        ))}\n                </Row>\n            );\n        }\n    };\n\n    const showPost = (type) => {\n        console.log(\"type -> \", type);\n        setActiveTab(type);\n\n        setTimeout(() => {\n            setSearchOption({ type: SEARCH_KEY.all, keyword: \"\" });\n        }, 3000);\n    };\n\n    const operations = <CreatePostButton onShowPost={showPost} />;\n    return (\n        <div className=\"home\">\n            <SearchBar handleSearch={handleSearch} />\n            <div className=\"display\">\n                <Tabs\n                    onChange={(key) => setActiveTab(key)}\n                    defaultActiveKey=\"image\"\n                    activeKey={activeTab}\n                    tabBarExtraContent={operations}\n                >\n                    <TabPane tab=\"Images\" key=\"image\">\n                        {renderPosts(\"image\")}\n                    </TabPane>\n                    <TabPane tab=\"Videos\" key=\"video\">\n                        {renderPosts(\"video\")}\n                    </TabPane>\n                </Tabs>\n            </div>\n        </div>\n    );\n}\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}